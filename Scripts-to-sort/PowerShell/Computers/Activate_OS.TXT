Clear-History
Clear-Host
Write-Host ' '
Write-Host 'OS Activation Script - Searching for your Certificates:'
Write-Host ' '

$Certs = (Get-ChildItem Cert:\CurrentUser\My)
If ($Certs -eq $null){
Write-Host "No Certificates were found, existing in: " -ForegroundColor Green -NoNewline
Start-Sleep -Seconds 1
5..1 | Foreach-Object {
    Write-Host "$_ " -NoNewline -ForegroundColor Green
    Start-Sleep -Seconds 1 }
Exit
}

$Menu = @{}
$CNT = 0
ForEach ($Cert in $Certs){
If ($CNT -le $Certs.count){ $CNT++ }
Write-Host $CNT ($Cert).Thumbprint ($Cert).Subject
$Menu.Add($CNT,($Cert[$CNT-1].name))
}

Write-Host ' '
$Selection = Read-Host 'Which Certificate would you like to use?'
$Menu.Item($Selection) ; slmgr.vbs /fta ($Cert).Thumbprint

# Digital Signature
# SIG # Begin signature block
# MIILnAYJKoZIhvcNAQcCoIILjTCCC4kCAQExCzAJBgUrDgMCGgUAMGkGCisGAQQB
# gjcCAQSgWzBZMDQGCisGAQQBgjcCAR4wJgIDAQAABBAfzDtgWUsITrck0sYpfvNR
# AgEAAgEAAgEAAgEAAgEAMCEwCQYFKw4DAhoFAAQU6ObFUPRdW0PNYS72c9RpWI7A
# MMugggkiMIIEfTCCA2WgAwIBAgIDCbxkMA0GCSqGSIb3DQEBCwUAMFoxCzAJBgNV
# BAYTAlVTMRgwFgYDVQQKEw9VLlMuIEdvdmVybm1lbnQxDDAKBgNVBAsTA0RvRDEM
# MAoGA1UECxMDUEtJMRUwEwYDVQQDEwxET0QgSUQgQ0EtNDEwHhcNMTYxMTI5MDAw
# MDAwWhcNMTkxMTI4MjM1OTU5WjB7MQswCQYDVQQGEwJVUzEYMBYGA1UEChMPVS5T
# LiBHb3Zlcm5tZW50MQwwCgYDVQQLEwNEb0QxDDAKBgNVBAsTA1BLSTEMMAoGA1UE
# CxMDVVNBMSgwJgYDVQQDEx9IQUxURVIuTUlDSEFFTC5BTExBTi4xMTE3MTQzNTI2
# MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAnU0zkS7MOOqPSEXULgfg
# za1AyHB6BdxmLdShPlWS9/qBCfbVffW8hgz7FRWJmbNguECWUnxNRQhMPGv0SiMK
# k05p/P9t7oyy84mdlZsUZzyC7gmFk6kkIeIkM/QX6hmPEnAYcDxt2QJk6VrQ8gnD
# c/EAl4ZXyXBEoR4saOO68puGG3ybXZg4DCoQBOgRM2szwJDmogrZQepSX5nmwlvZ
# SUnrMd4UAwCjG4xCVtzmXI4/WyqzaI9Ny+Yb0GJ2cPo50TEfNEdu3cdqwfskiUHI
# lYWmzo3Zi7RM/ZW59AeceKRRKK6e9OQt+pdqT2rt2l8paGOsWKVKxIztO2i9yJcU
# nQIDAQABo4IBKTCCASUwHwYDVR0jBBgwFoAUW5HGRDbyKPL4z7LCyMpjSWGbIAow
# NwYDVR0fBDAwLjAsoCqgKIYmaHR0cDovL2NybC5kaXNhLm1pbC9jcmwvRE9ESURD
# QV80MS5jcmwwDgYDVR0PAQH/BAQDAgbAMBYGA1UdIAQPMA0wCwYJYIZIAWUCAQsq
# MB0GA1UdDgQWBBQIXymK+twKuKK81QxlLf1GKhT8ojBlBggrBgEFBQcBAQRZMFcw
# MwYIKwYBBQUHMAKGJ2h0dHA6Ly9jcmwuZGlzYS5taWwvc2lnbi9ET0RJRENBXzQx
# LmNlcjAgBggrBgEFBQcwAYYUaHR0cDovL29jc3AuZGlzYS5taWwwGwYDVR0JBBQw
# EjAQBggrBgEFBQcJBDEEEwJVUzANBgkqhkiG9w0BAQsFAAOCAQEArBHfH9ZAgCE0
# EATDtopphOXPQaDf/j4UgQjgjMu29lFteAlGHFkp8mNtw28Oj7sk962zJhxdDhPQ
# t4D0MCrv+SzY6yAd31avX8vlGXha3TSJjZ52VRkBSDbVsoB+1jzWQa6Wpl4Pa8ZG
# 4SE89JMHd7ALzMNPvvsCvf63j0AOdhEHr95ZDzWBoONiJh85KoPrW586QlzcVWUD
# 5SvU4PLJmIXqUnKX5VpJFCdWt0My8dkkG5WS70saXPFBNLjSj+fI1iK2ecna9ni1
# yrAPKJeccnORhH0ErCDPA5bvXceBO8TVwPU/Ay39Y7PZTjVUUBJi6PFg/HJ6gkg8
# lQ8Eo5nH2TCCBJ0wggOFoAMCAQICARgwDQYJKoZIhvcNAQELBQAwWzELMAkGA1UE
# BhMCVVMxGDAWBgNVBAoTD1UuUy4gR292ZXJubWVudDEMMAoGA1UECxMDRG9EMQww
# CgYDVQQLEwNQS0kxFjAUBgNVBAMTDURvRCBSb290IENBIDMwHhcNMTUxMTA5MTYx
# MzU2WhcNMjExMTA5MTYxMzU2WjBaMQswCQYDVQQGEwJVUzEYMBYGA1UEChMPVS5T
# LiBHb3Zlcm5tZW50MQwwCgYDVQQLEwNEb0QxDDAKBgNVBAsTA1BLSTEVMBMGA1UE
# AxMMRE9EIElEIENBLTQxMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA
# t8l0iNgmviyR4M5oZ9jR/V5NNvkKBD7TuCt6B2vlynj9jHZOKKBct0i74s3/OMw1
# s6lT6KHxHaRdTaQ0/Pa5uSTo2iOTwZvXLeK1dGah9+A5QETFY7YVusklKdmAwyuX
# RpGUwAqpJxNgGi+++0cjy0REg6dafydsiJ1DLwnN8LCZqrXkluXVA6Ze/kvUldg/
# rq3+8weaAdOg/YuGJJ0od557Ybah0grzRdELacp08ncnAa2Wdgr+JRf4lT6YvPVg
# 0wI8FnN7ux1cR6govWeswe3iCF7SEXCgSa6i+6BMbwBrtAv9Q+v3UHzqh2uHDxIJ
# ZV38t/GcX51KxQooeE4w9QIDAQABo4IBazCCAWcwHwYDVR0jBBgwFoAUbIqUonex
# gHIdgXoWqvLczmbuRcAwHQYDVR0OBBYEFFuRxkQ28ijy+M+ywsjKY0lhmyAKMA4G
# A1UdDwEB/wQEAwIBhjBMBgNVHSAERTBDMAsGCWCGSAFlAgELJDALBglghkgBZQIB
# CycwCwYJYIZIAWUCAQsqMAwGCmCGSAFlAwIBAw0wDAYKYIZIAWUDAgEDETASBgNV
# HRMBAf8ECDAGAQH/AgEAMAwGA1UdJAQFMAOAAQAwNwYDVR0fBDAwLjAsoCqgKIYm
# aHR0cDovL2NybC5kaXNhLm1pbC9jcmwvRE9EUk9PVENBMy5jcmwwbAYIKwYBBQUH
# AQEEYDBeMDoGCCsGAQUFBzAChi5odHRwOi8vY3JsLmRpc2EubWlsL2lzc3VlZHRv
# L0RPRFJPT1RDQTNfSVQucDdjMCAGCCsGAQUFBzABhhRodHRwOi8vb2NzcC5kaXNh
# Lm1pbDANBgkqhkiG9w0BAQsFAAOCAQEAoeK0Yl/fCNbIMCf8BWiw7TNxpSk7pQ7u
# 1RqRpZZZYW1KWYmh0PKTFdoKBW6ADj18TJ5djdlDP1OP/UtrluJqLEKNoG3DU+62
# 4v0IZRJOGburWXpN0r4RSKvn5/14TKojMCDlDaq6IeQZ7zxi0HDKn5y3m0yZpHBu
# COjplz+np44fyXHTZ8TIWdWVI7utfksPINeHylepAFHaxoUD2QHHmci71Gow0Vy3
# cRV+y1oqdCCBTw+HjNqS8feDD6W8BaOP5fqzvCyuQS8RuGFe4SIsmrsLXERKDcI0
# chNEyfKk35s11MzO2MowUMrcnih2hMg21CwHtL31G/adY6MaBkjrnjGCAeQwggHg
# AgEBMGEwWjELMAkGA1UEBhMCVVMxGDAWBgNVBAoTD1UuUy4gR292ZXJubWVudDEM
# MAoGA1UECxMDRG9EMQwwCgYDVQQLEwNQS0kxFTATBgNVBAMTDERPRCBJRCBDQS00
# MQIDCbxkMAkGBSsOAwIaBQCgWjAYBgorBgEEAYI3AgEMMQowCKACgAChAoAAMBkG
# CSqGSIb3DQEJAzEMBgorBgEEAYI3AgEEMCMGCSqGSIb3DQEJBDEWBBQGwilEagWA
# PwUoum8tPAA9+2o+CTANBgkqhkiG9w0BAQEFAASCAQAD7COZEmAakusG+ziyyLZ1
# 9iUU0E0Y9amYab/uKSfvOA7q/+upUcQxax4jQ4XoWIsm4al06ez2OCSllGpQ/HTE
# 0CF8Mxr7QtrnH9CPCSjF7/1QhkY6oMyeUdlZLAKGyEbqwitEPg+mDBi43t1+PMWt
# SMlPxUdfltIkmZswV7XgtpF0GRU2OLu7QK/w9rXDZtRCKwdCN3U2NuHZ3mwxDCfL
# EM3tDboX1l+zfjQLo5jNXZ/i8rqFomo62c3nhQzwB9ml1OzhuXVnIvB7/RSz9M2z
# EIw4ZiSGWSA6Ou5oPIQlzfnsKWu5SQNrSvCSRJr4uBMcR8lyM8B/J5xEFBM1fs7q
# SIG # End signature block
